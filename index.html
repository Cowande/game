<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Live Spelers Grid</title>
<style>
  body { font-family:sans-serif; background:#111; color:#fff; display:flex; flex-direction:column; align-items:center; padding:20px;}
  h1 { margin-bottom:20px;}
  .grid { display:grid; grid-template-columns:repeat(10,40px); gap:5px;}
  .cell { width:40px; height:40px; background:#222; border-radius:4px;}
  .cell.active { background:#4caf50;}
</style>
</head>
<body>

<h1>Live Spelers</h1>
<div class="grid" id="grid"></div>
<p>Aantal spelers: <span id="count">0</span></p>

<script>
const userId = 'u_' + Math.random().toString(36).substr(2, 5);
const totalCells = 100;
const grid = document.getElementById('grid');

// Maak grid
for(let i=0;i<totalCells;i++){
  const div = document.createElement('div');
  div.className = 'cell';
  grid.appendChild(div);
}

// Functies om users op te slaan/halen
function getUsers(){ return JSON.parse(localStorage.getItem('users')||'{}'); }
function saveUsers(users){ localStorage.setItem('users', JSON.stringify(users)); }

// Voeg jezelf toe
function join(){
  const users = getUsers();
  users[userId] = Date.now();
  saveUsers(users);
}

// Verwijder jezelf bij afsluiten
window.addEventListener('beforeunload', ()=> {
  const users = getUsers();
  delete users[userId];
  saveUsers(users);
});

// Update grid
function update(){
  const users = getUsers();
  const now = Date.now();
  // verwijder oude users (>10 sec)
  for(const id in users){
    if(now - users[id] > 10000) delete users[id];
  }
  saveUsers(users);

  const activeUsers = Object.keys(users);
  document.getElementById('count').textContent = activeUsers.length;

  const cells = document.querySelectorAll('.cell');
  cells.forEach(c=>c.classList.remove('active'));
  activeUsers.forEach((_,i)=>{ if(i<cells.length) cells[i].classList.add('active'); });
}

// Start
join();
update();
setInterval(()=>{ join(); update(); }, 2000);
</script>

</body>
</html>
