<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Live Spelers Grid Wereldwijd</title>
<style>
  body { font-family:sans-serif; background:#111; color:#fff; display:flex; flex-direction:column; align-items:center; padding:20px;}
  h1 { margin-bottom:20px;}
  .grid { display:grid; grid-template-columns:repeat(10,40px); gap:5px;}
  .cell { width:40px; height:40px; background:#222; border-radius:4px;}
  .cell.active { background:#4caf50;}
</style>
</head>
<body>

<h1>Live Spelers</h1>
<div class="grid" id="grid"></div>
<p>Aantal spelers: <span id="count">0</span></p>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script>
  // ====== Firebase Config ======
  const firebaseConfig = {
    apiKey: "JE_API_KEY_HIER",
    authDomain: "JE_PROJECT.firebaseapp.com",
    databaseURL: "https://zever-7eca0-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "zever-7eca0",
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // ====== Grid Setup ======
  const totalCells = 100;
  const grid = document.getElementById('grid');
  for(let i=0;i<totalCells;i++){
    const div = document.createElement('div');
    div.className = 'cell';
    grid.appendChild(div);
  }

  // ====== Unieke gebruiker ======
  const userId = 'u_' + Math.random().toString(36).substr(2,5);

  // Voeg jezelf toe en verwijder bij afsluiten
  function join() {
    db.ref('users/'+userId).set({ lastActive: Date.now() });
    db.ref('users/'+userId).onDisconnect().remove();
  }

  // Update grid
  function updateGrid() {
    db.ref('users').once('value').then(snapshot=>{
      const users = snapshot.val() || {};
      const now = Date.now();
      // Alleen actieve users (<10 sec)
      const activeUsers = Object.values(users).filter(u => now - u.lastActive < 10000);
      document.getElementById('count').textContent = activeUsers.length;

      const cells = document.querySelectorAll('.cell');
      cells.forEach(c=>c.classList.remove('active'));
      activeUsers.forEach((_,i)=>{ if(i<cells.length) cells[i].classList.add('active'); });
    });
  }

  // ====== Start ======
  join();
  updateGrid();
  setInterval(()=>{
    // update laatste activiteit
    db.ref('users/'+userId).update({ lastActive: Date.now() });
    updateGrid();
  }, 2000);
</script>

</body>
</html>
